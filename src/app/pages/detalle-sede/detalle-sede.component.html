<div class="dashboard-container">
  <!-- ğŸ“Œ BotÃ³n de menÃº para dispositivos mÃ³viles -->
  <button class="menu-toggle" (click)="toggleSidebar()">â˜°</button>

  <!-- ğŸ“Œ Fondo semitransparente al abrir el sidebar -->
  <div class="sidebar-overlay" [class.active]="sidebarAbierto" (click)="toggleSidebar()"></div>

  <!-- ğŸ“Œ Sidebar -->
  <div class="sidebar" [class.active]="sidebarAbierto">
    <h3>Detalle de Sede</h3>
    <ul class="nav flex-column">
      <li class="nav-item"><button class="btn-sidebar" routerLink="/dashboard">ğŸ  Dashboard</button></li>
      <li class="nav-item"><button class="btn-sidebar" routerLink="/sedes">ğŸ“ Sedes</button></li>
      <li class="nav-item"><button class="btn-sidebar" routerLink="/trabajadores">ğŸ‘· Trabajadores</button></li>
      <li class="nav-item"><button class="btn-sidebar" routerLink="/calendario-laboral">ğŸ“… Calendario Laboral</button></li>
      <li class="nav-item"><button class="btn-sidebar" routerLink="/acerca-de">â„¹ï¸ Acerca de</button></li>
      <li class="nav-item" *ngIf="esAdmin()">
        <button class="btn-sidebar" routerLink="/admin-dashboard">ğŸ§‘â€ğŸ’¼ Ver Usuarios</button>
      </li>
    </ul>
    <button class="btn-logout" (click)="cerrarSesion()">âŒ Cerrar SesiÃ³n</button>
  </div>

  <!-- ğŸ“Œ Contenido principal -->
  <div class="main-content">
        <!-- ğŸš¨ Alerta de sede en proceso de eliminaciÃ³n -->
    <div *ngIf="sede?.estado === 'eliminacion_pendiente'" class="alerta-pendiente">
      âš ï¸ Esta sede estÃ¡ en proceso de eliminaciÃ³n. Tienes 15 dÃ­as para cancelarlo antes de que se elimine automÃ¡ticamente.
    </div>
    <div class="welcome-card">
      <h2>{{ sede?.nombre }} (ID: {{ sede?.id }})</h2>
      <p>AdministraciÃ³n de datos de la sede.</p>
    </div>

    <div class="boton-descarga">
      <button class="btn-update" (click)="generarPdfPorSede()">
        ğŸ“„ Descargar PDF de asistencias
      </button>
    </div>
    <p></p>

    <div class="card">
      <h3>ğŸ“ InformaciÃ³n de la sede</h3>
      <form class="form-sede">
        <div class="form-group">
          <label>ID:</label>
          <input type="text" [value]="sede?.id" disabled />
        </div>
        <div class="form-group">
          <label>Nombre:</label>
          <input type="text" [value]="sede?.nombre" disabled />
        </div>
        <div class="form-group">
          <label>DirecciÃ³n:</label>
          <input [(ngModel)]="sede.direccion" name="direccion" [disabled]="esSoloRevisor()" [ngClass]="{'input-disabled': esSoloRevisor()}" />
        </div>
        <div class="form-group">
          <label>Zona:</label>
          <input [(ngModel)]="sede.zona" name="zona" [disabled]="esSoloRevisor()" [ngClass]="{'input-disabled': esSoloRevisor()}" />
        </div>
        <div class="form-group">
          <label>Responsable:</label>
          <input [(ngModel)]="sede.responsable" name="responsable" [disabled]="esSoloRevisor()" [ngClass]="{'input-disabled': esSoloRevisor()}" />
        </div>
        <button class="btn-update" (click)="guardarCambios()" *ngIf="!esSoloRevisor()">
          <i class="bi bi-save"></i> Guardar Cambios
        </button>
      </form>
    </div>

    <div class="card">
      <h3>ğŸ‘¥ Trabajadores de esta sede</h3>
      <div class="search-container">
        <label class="search-label">ğŸ” Buscar por nombre o apellido:</label>
        <mat-form-field appearance="fill">
          <mat-label>Buscar trabajador</mat-label>
          <input matInput [(ngModel)]="busquedaTrabajador" placeholder="Nombre o apellido">
        </mat-form-field>
      </div>

      <table class="tabla-sedes">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let trabajador of trabajadoresFiltrados()">
            <td>{{ trabajador.id_checador }}</td>
            <td>{{ trabajador.nombre }}</td>
            <td>
              <button class="btn-view" (click)="verDetalleTrabajador(trabajador._id)">Ver</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="card">
      <h3>ğŸ“… Calendario laboral de la sede</h3>
      <app-calendario-sede
        [sede]="sede.id"
        [sedeNombre]="sede.nombre"
        [anio]="anioActual"
        [eventos]="eventos"
        [todasLasSedes]="todasLasSedes"
        (eventoGuardado)="guardarEventoDesdeCalendario($event)"
        (eventoEliminado)="eliminarEventoDesdeCalendario($event)">
      </app-calendario-sede>

      <button class="btn-update" routerLink="/calendario-laboral" *ngIf="!esSoloRevisor()">
        <i class="bi bi-calendar-plus"></i> Modificar en Calendario Laboral
      </button>
    </div>

    <!-- ğŸ”¥ EliminaciÃ³n o cancelaciÃ³n de sede (solo Dios) -->
    <div class="card" *ngIf="esDios()">
      <h3 style="color: red;">âš ï¸ AcciÃ³n peligrosa</h3>
      <p *ngIf="sede.estado === 'activa'">
        Este botÃ³n eliminarÃ¡ la sede y todos sus trabajadores. AsegÃºrate de tener respaldo antes de continuar.
      </p>
      <p *ngIf="sede.estado === 'eliminacion_pendiente'">
        Esta sede estÃ¡ en proceso de eliminaciÃ³n. Tienes 15 dÃ­as para revertirlo antes de que se elimine permanentemente.
      </p>

      <button
        class="btn-danger"
        *ngIf="sede.estado === 'activa'"
        (click)="eliminarSede()">
        <i class="bi bi-trash-fill"></i> Eliminar Sede
      </button>

      <button
        class="btn-warning"
        *ngIf="sede.estado === 'eliminacion_pendiente'"
        (click)="cancelarEliminacionSede()">
        <i class="bi bi-arrow-counterclockwise"></i> Cancelar EliminaciÃ³n
      </button>
    </div>
  </div>
</div>
