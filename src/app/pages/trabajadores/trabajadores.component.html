<div class="admin-dashboard-container">
  <!-- ğŸ“Œ BotÃ³n y fondo para el sidebar en mÃ³viles -->
  <button class="menu-toggle" (click)="toggleSidebar()">â˜°</button>
  <div class="sidebar-overlay" (click)="toggleSidebar()"></div>

  <!-- ğŸ“Œ Sidebar -->
  <div class="sidebar">
    <h3>Panel de Trabajadores</h3>
    <ul class="nav flex-column">
      <li class="nav-item"><button class="btn-sidebar" routerLink="/dashboard">ğŸ  Dashboard</button></li>
      <li class="nav-item"><button class="btn-sidebar" routerLink="/sedes">ğŸ“ Sedes</button></li>
      <li class="nav-item"><button class="btn-sidebar" routerLink="/trabajadores">ğŸ‘· Trabajadores</button></li>
      <li class="nav-item"><button class="btn-sidebar" routerLink="/perfil">ğŸ‘¤ Perfil</button></li>
      <li class="nav-item"><button class="btn-sidebar" routerLink="/acerca-de">â„¹ï¸ Acerca de</button></li>
    </ul>
    <button class="btn-logout" (click)="cerrarSesion()">âŒ Cerrar SesiÃ³n</button>
  </div>

  <!-- ğŸ“Œ Contenido principal -->
  <div class="main-content">
    <div class="content-container">
      <!-- ğŸ“ Encabezado -->
      <div class="welcome-card">
        <h2>Lista de Trabajadores ğŸ‘·</h2>
        <p>Gestiona los trabajadores registrados en el sistema.</p>
      </div>

      <!-- ğŸ“Œ Motor de bÃºsqueda -->
      <div class="search-container">
        <select [(ngModel)]="filtroSede">
          <option value="">Todas las sedes</option>
          <option *ngFor="let sede of sedes" [value]="sede.id">{{ sede.nombre }}</option>
        </select>
        <input type="text" [(ngModel)]="filtroNombre" placeholder="Buscar por nombre..." />
        <button class="btn-buscar" (click)="filtrarTrabajadores()">ğŸ” Buscar</button>
      </div>

      <!-- ğŸ“Œ Formulario para agregar trabajador -->
      <div class="add-worker-form" *ngIf="rolUsuario !== 'Revisor'">
        <input type="text" placeholder="Nombre del trabajador" #nombre />
        <select #sede>
          <option *ngFor="let sedeItem of sedes" [value]="sedeItem.id">{{ sedeItem.nombre }}</option>
        </select>
        <button class="btn-agregar" (click)="abrirModalAgregar(nombre.value, sede.value)">â• Agregar</button>
      </div>

      <!-- ğŸ“Œ Mat-card transparente para botÃ³n actualizar -->
      <div class="search-container transparente" style="justify-content: flex-end;">
        <div class="update-table-container">
          <button class="btn-update" (click)="actualizarTabla()">ğŸ”„ Actualizar Tabla</button>
        </div>
      </div>

      <!-- ğŸ“Œ Tabla de trabajadores -->
      <div class="user-table">
        <table>
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Sede</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let trabajador of trabajadoresFiltrados">
              <td>{{ trabajador.nombre }}</td>
              <td>{{ obtenerNombreSede(trabajador.sede) }}</td>
              <td>
                <span [ngClass]="{ 'activo': trabajador.sincronizado, 'pendiente': !trabajador.sincronizado }">
                  {{ trabajador.sincronizado ? 'âœ… Sincronizado' : 'â³ Pendiente' }}
                </span>
              </td>
              <td class="btn-actions">
                <button class="btn-view" (click)="verTrabajador(trabajador._id!)">
                  <i class="fas fa-eye"></i> Ver
                </button>
              </td>
            </tr>
            <tr *ngIf="trabajadoresFiltrados.length === 0">
              <td colspan="4">ğŸ˜¢ No se encontraron trabajadores con esos criterios.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ğŸ“Œ Modal contraseÃ±a agregar -->
  <div class="modal" *ngIf="mostrarModalContrasena">
    <div class="modal-content">
      <h3>ğŸ”’ Ingresa tu contraseÃ±a</h3>
      <input type="password" [(ngModel)]="contrasena" placeholder="ContraseÃ±a" class="input-contraseÃ±a" />
      <div class="modal-buttons">
        <button class="btn-confirmar" (click)="confirmarAgregarTrabajador()">Confirmar</button>
        <button class="btn-cancelar" (click)="cerrarModalContrasena()">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- ğŸ“Œ Modal de mensajes -->
  <div class="modal" *ngIf="mostrarModalMensaje">
    <div class="modal-content" [ngClass]="{
      'modal-exito': tipoMensajeModal === 'exito',
      'modal-error': tipoMensajeModal === 'error',
      'modal-advertencia': tipoMensajeModal === 'advertencia'
    }">
      <h3 *ngIf="tipoMensajeModal === 'exito'">ğŸŸ¢ Ã‰xito</h3>
      <h3 *ngIf="tipoMensajeModal === 'error'">ğŸ”´ Error</h3>
      <h3 *ngIf="tipoMensajeModal === 'advertencia'">ğŸŸ¡ Advertencia</h3>
      <p>{{ mensajeModal }}</p>
      <button class="btn-cerrar" (click)="cerrarModalMensaje()">Aceptar</button>
    </div>
  </div>
</div>
